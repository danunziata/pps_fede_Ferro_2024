
<!doctype html>
<html lang="es" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Seguridad de entornos contenerizados con enfoque en Kubernetes.">
      
      
        <meta name="author" content="Rodriguez Ferro Federico">
      
      
      
        <link rel="prev" href="../contexto/">
      
      
        <link rel="next" href="../lens/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.26">
    
    
      
        <title>Instalación - PPS - Federico Rodriguez Ferro</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.6543a935.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue-grey" data-md-color-accent="lime">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#instalacion" class="md-skip">
          Saltar a contenido
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Cabecera">
    <a href=".." title="PPS - Federico Rodriguez Ferro" class="md-header__button md-logo" aria-label="PPS - Federico Rodriguez Ferro" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            PPS - Federico Rodriguez Ferro
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Instalación
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="blue-grey" data-md-color-accent="lime"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="blue-grey" data-md-color-accent="purple"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Búsqueda" placeholder="Búsqueda" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Buscar">
        
        <button type="reset" class="md-search__icon md-icon" title="Limpiar" aria-label="Limpiar" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Inicializando búsqueda
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/danunziata/pps_fede_Ferro_2024" title="Ir al repositorio" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    danunziata/pps_fede_Ferro_2024
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navegación" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="PPS - Federico Rodriguez Ferro" class="md-nav__button md-logo" aria-label="PPS - Federico Rodriguez Ferro" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    PPS - Federico Rodriguez Ferro
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/danunziata/pps_fede_Ferro_2024" title="Ir al repositorio" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    danunziata/pps_fede_Ferro_2024
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introducción
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../contexto/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Conceptos
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Instalación
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Instalación
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tabla de contenidos
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#prerequesitos" class="md-nav__link">
    <span class="md-ellipsis">
      Prerequesitos
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Prerequesitos">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zsh" class="md-nav__link">
    <span class="md-ellipsis">
      ZSH
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kvm" class="md-nav__link">
    <span class="md-ellipsis">
      KVM
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kubectl" class="md-nav__link">
    <span class="md-ellipsis">
      Kubectl
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#desarrollo" class="md-nav__link">
    <span class="md-ellipsis">
      Desarrollo
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Desarrollo">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#instalacion_1" class="md-nav__link">
    <span class="md-ellipsis">
      Instalación
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creacion-de-cluster" class="md-nav__link">
    <span class="md-ellipsis">
      Creacion de Cluster
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#despliegue-de-una-aplicacion-python" class="md-nav__link">
    <span class="md-ellipsis">
      Despliegue de una aplicación Python
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#laboratorio" class="md-nav__link">
    <span class="md-ellipsis">
      Laboratorio
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Laboratorio">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#multipass" class="md-nav__link">
    <span class="md-ellipsis">
      Multipass
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creacion-de-instancias" class="md-nav__link">
    <span class="md-ellipsis">
      Creación de Instancias
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Creación de Instancias">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#claves-ssh" class="md-nav__link">
    <span class="md-ellipsis">
      Claves SSH
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creando-el-archivo-de-configuracion" class="md-nav__link">
    <span class="md-ellipsis">
      Creando el archivo de configuración
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#inicializacion" class="md-nav__link">
    <span class="md-ellipsis">
      Inicialización
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#k3sup" class="md-nav__link">
    <span class="md-ellipsis">
      k3sup
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#instalacion_2" class="md-nav__link">
    <span class="md-ellipsis">
      Instalación
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#anadiendo-nodos-con-k3sup" class="md-nav__link">
    <span class="md-ellipsis">
      Añadiendo nodos con k3sup
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Añadiendo nodos con k3sup">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#nodo-maestro" class="md-nav__link">
    <span class="md-ellipsis">
      Nodo maestro
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nodo-worker" class="md-nav__link">
    <span class="md-ellipsis">
      Nodo worker
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#referencias" class="md-nav__link">
    <span class="md-ellipsis">
      Referencias
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lens/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Administración
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Seguridad
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Seguridad
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../seguridad/autentificacion/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Autentificación
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../seguridad/seguridad/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Seguridad
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../seguridad/monitoreo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Monitoreo
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../seguridad/scanning/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Escaneo
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Proyecto
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Proyecto
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../proyecto/metodologia/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Metodologia de Trabajo
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../proyecto/contributing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contribución
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tabla de contenidos
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#prerequesitos" class="md-nav__link">
    <span class="md-ellipsis">
      Prerequesitos
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Prerequesitos">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zsh" class="md-nav__link">
    <span class="md-ellipsis">
      ZSH
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kvm" class="md-nav__link">
    <span class="md-ellipsis">
      KVM
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kubectl" class="md-nav__link">
    <span class="md-ellipsis">
      Kubectl
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#desarrollo" class="md-nav__link">
    <span class="md-ellipsis">
      Desarrollo
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Desarrollo">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#instalacion_1" class="md-nav__link">
    <span class="md-ellipsis">
      Instalación
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creacion-de-cluster" class="md-nav__link">
    <span class="md-ellipsis">
      Creacion de Cluster
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#despliegue-de-una-aplicacion-python" class="md-nav__link">
    <span class="md-ellipsis">
      Despliegue de una aplicación Python
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#laboratorio" class="md-nav__link">
    <span class="md-ellipsis">
      Laboratorio
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Laboratorio">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#multipass" class="md-nav__link">
    <span class="md-ellipsis">
      Multipass
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creacion-de-instancias" class="md-nav__link">
    <span class="md-ellipsis">
      Creación de Instancias
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Creación de Instancias">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#claves-ssh" class="md-nav__link">
    <span class="md-ellipsis">
      Claves SSH
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creando-el-archivo-de-configuracion" class="md-nav__link">
    <span class="md-ellipsis">
      Creando el archivo de configuración
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#inicializacion" class="md-nav__link">
    <span class="md-ellipsis">
      Inicialización
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#k3sup" class="md-nav__link">
    <span class="md-ellipsis">
      k3sup
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#instalacion_2" class="md-nav__link">
    <span class="md-ellipsis">
      Instalación
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#anadiendo-nodos-con-k3sup" class="md-nav__link">
    <span class="md-ellipsis">
      Añadiendo nodos con k3sup
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Añadiendo nodos con k3sup">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#nodo-maestro" class="md-nav__link">
    <span class="md-ellipsis">
      Nodo maestro
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nodo-worker" class="md-nav__link">
    <span class="md-ellipsis">
      Nodo worker
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#referencias" class="md-nav__link">
    <span class="md-ellipsis">
      Referencias
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="instalacion">Instalación</h1>
<p>En este documento, desarrollaremos dos entornos totalmente diferentes que pueden ser utilizados para replicar el clúster en el que trabajaremos, de una forma más liviana y que pueda ser soportada por nuestra máquina personal.</p>
<p>El primer entorno de desarrollo estará centrado en replicar el clúster de una forma liviana, permitiendo que nuestra máquina personal pueda soportarlo sin problemas. En este caso utilizaremos minikube que es una de las herramientas mas facil de implementar y utilizar a la hora de hacer nuestro primer acercamiento a Kubernetes</p>
<p>El segundo entorno de laboratorio se configurará utilizando KVM y Multipass, diseñado específicamente para instalar Kubernetes utilizando la tecnología k3s. Este método proporciona una solución eficiente y manejable para desplegar Kubernetes en un entorno de virtualización. Tiene una mejor aproximacion a las implementaciones reales.</p>
<h2 id="prerequesitos">Prerequesitos</h2>
<h3 id="zsh">ZSH</h3>
<p>zsh es un intérprete de comandos de Unix que ofrece funcionalidades avanzadas en comparación con otros shells comunes, como Bash (Bourne Again Shell). Zsh incluye características como completado de comandos más robusto, expansión de nombres de archivo mejorada, temas y personalización más avanzada, corrección ortográfica integrada, entre otras. Es altamente configurable y es utilizado por muchos usuarios  avanzados y desarrolladores como su shell predeterminado debido a su  potencia y flexibilidad.</p>
<p>Para Instalarlo simplemente ejecutamos la siguiente linea en nuestra terminal</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>sudo<span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>zsh
</code></pre></div>
<p>Para ejecutarlo</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>zsh
</code></pre></div>
<p>En caso de que se quiera personalizar el shell se puede descargar el framework Oh My Zsh con el siguiente comando</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>sh<span class="w"> </span>-c<span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span>curl<span class="w"> </span>-fsSL<span class="w"> </span>https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh<span class="k">)</span><span class="s2">&quot;</span>
</code></pre></div>
<p>Toda la documentación acerca de ohmyzsh se encuentra en la <a href="https://github.com/ohmyzsh/ohmyzsh/wiki/Themes">wiki</a>.</p>
<h3 id="kvm">KVM</h3>
<p>Las máquinas virtuales basadas en el kernel (KVM) son una tecnología de virtualizaciónopen source integrada a Linux®. Con ellas, puede transformar Linux en un hipervisor que permite que una máquina host ejecute varios entornos virtuales aislados llamados máquinas virtuales (VM) o guests. </p>
<p>Las KVM convierten Linux en un hipervisor de tipo 1. Todos los hipervisores necesitan algunos elementos del sistema operativo (por ejemplo, el administrador de memoria, el programador de procesos, la stack de entrada o salida [E/S], los controladores de dispositivos, el administrador de seguridad y la stack de red, entre otros) para ejecutar las máquinas virtuales. Las KVM tienen todos estos elementos porque forman parte del kernel de Linux. Cada máquina virtual se implementa como un proceso habitual de Linux, el cual se programa con la herramienta estándar de Linux para este fin, e incluye sistemas virtuales de hardware exclusivos, como la tarjeta de red, el adaptador gráfico, las CPU, la memoria y los discos.</p>
<p><strong>Instalación</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>sudo<span class="w"> </span>apt<span class="w"> </span>update
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>cpu-checker
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>kvm-ok<span class="w">                                                                   </span><span class="c1"># Comprueba si la virtualizacion esta habilitada</span>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>qemu-kvm<span class="w"> </span>libvirt-bin<span class="w"> </span>bridge-utils<span class="w"> </span>virtinst<span class="w"> </span>virt-manager<span class="w"> </span><span class="c1"># Instala las librerias necesarias</span>
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a>sudo<span class="w"> </span>usermod<span class="w"> </span>-aG<span class="w"> </span>kvm,libvirt<span class="w"> </span><span class="nv">$USER</span><span class="w">                                       </span><span class="c1"># Agrupa un par de grupos a un usuario</span>
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a>sudo<span class="w"> </span>systemctl<span class="w"> </span>is-active<span class="w"> </span>libvirtd<span class="w">                                        </span><span class="c1"># &quot;active&quot; si esta todo activado</span>
</code></pre></div>
<h3 id="kubectl">Kubectl</h3>
<p>Es una herramienta de línea de comandos de Kubernetes para desplegar y gestionar aplicaciones en Kubernetes. Usando kubectl, puedes inspeccionar recursos del clúster; crear, eliminar, y actualizar  componentes; explorar tu nuevo clúster y arrancar aplicaciones.</p>
<p><strong>Instalación</strong></p>
<p>Descargar la ultima version</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>curl<span class="w"> </span>-LO<span class="w"> </span><span class="s2">&quot;https://dl.k8s.io/release/</span><span class="k">$(</span>curl<span class="w"> </span>-L<span class="w"> </span>-s<span class="w"> </span>https://dl.k8s.io/release/stable.txt<span class="k">)</span><span class="s2">/bin/linux/amd64/kubectl&quot;</span>
</code></pre></div>
<p>Instalarlo</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>sudo<span class="w"> </span>install<span class="w"> </span>-o<span class="w"> </span>root<span class="w"> </span>-g<span class="w"> </span>root<span class="w"> </span>-m<span class="w"> </span><span class="m">0755</span><span class="w"> </span>kubectl<span class="w"> </span>/usr/local/bin/kubectl
</code></pre></div>
<p>Comprobar que se ha instalado de manera correcta</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>kubectl<span class="w"> </span>version<span class="w"> </span>--client
</code></pre></div>
<h2 id="desarrollo">Desarrollo</h2>
<p>Minikube es una herramienta de código abierto que facilita la creación y ejecución de clústeres de Kubernetes localmente en una máquina individual. En un sentido técnico, Minikube utiliza una máquina virtual para crear un entorno de clúster de Kubernetes que se ejecuta en una sola instancia de host. Utiliza tecnologías como Docker y KVM (Kernel-based Virtual Machine) para emular un entorno de múltiples nodos Kubernetes en una sola máquina física, lo que permite a los desarrolladores experimentar, probar y desarrollar aplicaciones Kubernetes sin necesidad de un entorno de producción completo. Minikube proporciona una forma rápida y conveniente de familiarizarse con Kubernetes y probar aplicaciones en un entorno de desarrollo local antes de implementarlas en un clúster de producción.</p>
<h3 id="instalacion_1">Instalación</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>curl<span class="w"> </span>-LO<span class="w"> </span>https://storage.googleapis.com/minikube/releases/latest/minikube-linux-amd64
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>sudo<span class="w"> </span>install<span class="w"> </span>minikube-linux-amd64<span class="w"> </span>/usr/local/bin/minikube<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>rm<span class="w"> </span>minikube-linux-amd64
</code></pre></div>
<h3 id="creacion-de-cluster">Creacion de Cluster</h3>
<p>Para comenzar, iniciaremos arrancando el cluster teniendo en cuenta los parámetros que queremos que cumpla. Para ello, propondremos la siguiente linea de comando</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>minikube<span class="w"> </span>start<span class="w"> </span>--driver<span class="o">=</span>kvm2<span class="w"> </span>--nodes<span class="o">=</span><span class="s2">&quot;Cantidad de nodos&quot;</span><span class="w"> </span>--memory<span class="o">=</span><span class="s2">&quot;Cantidad de Memoria&quot;</span><span class="w"> </span>--cpu<span class="o">=</span><span class="s2">&quot;Cantidad de cpu&quot;</span>
</code></pre></div>
<p>A partir de aqui, nosotros podemos empezar a experimentar con la creacion de Pods que sean capaces de alojar nuestras aplicaciones.</p>
<p>Un Pod es un grupo de uno o más contenedores, con almacenamiento/red compartidos, y unas especificaciones de cómo ejecutar los contenedores. Los contenidos de un Pod son siempre coubicados, coprogramados y ejecutados en un contexto compartido. Un Pod modela un "host lógico" específico de la aplicación: contiene uno o más contenedores de aplicaciones relativamente entrelazados. Antes de la llegada de los contenedores, ejecutarse en la misma máquina física o virtual significaba ser ejecutado en el mismo host lógico.</p>
<h3 id="despliegue-de-una-aplicacion-python">Despliegue de una aplicación Python</h3>
<p>Para concluir con este entorno de laboratorio, desplegaremos una aplicacion web programada en python como es Flask para hacer uso de todo el conocimiento que vimos en este documento.</p>
<p>Empezaremos creando un Cluster simple de 2 nodos utilizando KVM, por el momento dejaremos el uso de nucleos y de RAM por defecto</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>minikube<span class="w"> </span>start<span class="w"> </span>--driver<span class="o">=</span>kvm2<span class="w"> </span>--nodes<span class="o">=</span><span class="m">2</span>
</code></pre></div>
<p>Comprobamos que los nodos han sido habilitados de manera correcta</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>kubectl<span class="w"> </span>get<span class="w"> </span>nodes
</code></pre></div>
<p>Para correr la aplicacion utilizaremos el siguiente archivo deployment.yaml que cuenta con todo lo que necesitamos para ejecutar la aplicacion</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Service</span>
<a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a><span class="nt">metadata</span><span class="p">:</span>
<a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">hello-python-service</span>
<a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a><span class="nt">spec</span><span class="p">:</span>
<a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a><span class="w">  </span><span class="nt">selector</span><span class="p">:</span>
<a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a><span class="w">    </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">hello-python</span>
<a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a><span class="w">  </span><span class="nt">ports</span><span class="p">:</span>
<a id="__codelineno-11-9" name="__codelineno-11-9" href="#__codelineno-11-9"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;TCP&quot;</span>
<a id="__codelineno-11-10" name="__codelineno-11-10" href="#__codelineno-11-10"></a><span class="w">    </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">6000</span>
<a id="__codelineno-11-11" name="__codelineno-11-11" href="#__codelineno-11-11"></a><span class="w">    </span><span class="nt">targetPort</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5000</span>
<a id="__codelineno-11-12" name="__codelineno-11-12" href="#__codelineno-11-12"></a><span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">LoadBalancer</span>
<a id="__codelineno-11-13" name="__codelineno-11-13" href="#__codelineno-11-13"></a>
<a id="__codelineno-11-14" name="__codelineno-11-14" href="#__codelineno-11-14"></a><span class="nn">---</span>
<a id="__codelineno-11-15" name="__codelineno-11-15" href="#__codelineno-11-15"></a><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">apps/v1</span>
<a id="__codelineno-11-16" name="__codelineno-11-16" href="#__codelineno-11-16"></a><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Deployment</span>
<a id="__codelineno-11-17" name="__codelineno-11-17" href="#__codelineno-11-17"></a><span class="nt">metadata</span><span class="p">:</span>
<a id="__codelineno-11-18" name="__codelineno-11-18" href="#__codelineno-11-18"></a><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">hello-python</span>
<a id="__codelineno-11-19" name="__codelineno-11-19" href="#__codelineno-11-19"></a><span class="nt">spec</span><span class="p">:</span>
<a id="__codelineno-11-20" name="__codelineno-11-20" href="#__codelineno-11-20"></a><span class="w">  </span><span class="nt">selector</span><span class="p">:</span>
<a id="__codelineno-11-21" name="__codelineno-11-21" href="#__codelineno-11-21"></a><span class="w">    </span><span class="nt">matchLabels</span><span class="p">:</span>
<a id="__codelineno-11-22" name="__codelineno-11-22" href="#__codelineno-11-22"></a><span class="w">      </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">hello-python</span>
<a id="__codelineno-11-23" name="__codelineno-11-23" href="#__codelineno-11-23"></a><span class="w">  </span><span class="nt">replicas</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">4</span>
<a id="__codelineno-11-24" name="__codelineno-11-24" href="#__codelineno-11-24"></a><span class="w">  </span><span class="nt">template</span><span class="p">:</span>
<a id="__codelineno-11-25" name="__codelineno-11-25" href="#__codelineno-11-25"></a><span class="w">    </span><span class="nt">metadata</span><span class="p">:</span>
<a id="__codelineno-11-26" name="__codelineno-11-26" href="#__codelineno-11-26"></a><span class="w">      </span><span class="nt">labels</span><span class="p">:</span>
<a id="__codelineno-11-27" name="__codelineno-11-27" href="#__codelineno-11-27"></a><span class="w">        </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">hello-python</span>
<a id="__codelineno-11-28" name="__codelineno-11-28" href="#__codelineno-11-28"></a><span class="w">    </span><span class="nt">spec</span><span class="p">:</span>
<a id="__codelineno-11-29" name="__codelineno-11-29" href="#__codelineno-11-29"></a><span class="w">      </span><span class="nt">containers</span><span class="p">:</span>
<a id="__codelineno-11-30" name="__codelineno-11-30" href="#__codelineno-11-30"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">hello-python</span>
<a id="__codelineno-11-31" name="__codelineno-11-31" href="#__codelineno-11-31"></a><span class="w">        </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">hello-python:latest</span>
<a id="__codelineno-11-32" name="__codelineno-11-32" href="#__codelineno-11-32"></a><span class="w">        </span><span class="nt">imagePullPolicy</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Never</span>
<a id="__codelineno-11-33" name="__codelineno-11-33" href="#__codelineno-11-33"></a><span class="w">        </span><span class="nt">ports</span><span class="p">:</span>
<a id="__codelineno-11-34" name="__codelineno-11-34" href="#__codelineno-11-34"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">containerPort</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5000</span>
</code></pre></div>
<p>Como se observa en este script, se estan aplicando 2 caracteristicas que distinguen a los Kubernetes:</p>
<ul>
<li><strong>Servicio LoadBalancer</strong>: es la forma estándar de exponer un servicio a Internet. Si se desea exponer directamente un servicio, este es el método  predeterminado. Todo el tráfico en el puerto que especifique se reenviará al servicio. No hay filtrado, ni enrutamiento, etc. Esto  significa que puedes enviarle casi cualquier tipo de tráfico, como HTTP, TCP, UDP, Websockets, gRPC o lo que sea. En este caso se le expone el puerto 5000 para que pueda ser accedido de forma local por el puerto 6000.</li>
<li><strong>Deployment</strong>: se refiere a un objeto que describe cómo se debe implementar y actualizar una aplicación en el clúster. Proporciona un enfoque declarativo para definir el estado deseado de la aplicación y permite que Kubernetes se encargue de llevar el estado actual al estado deseado de manera eficiente y confiable. Simplifica el proceso de despliegue y actualización de aplicaciones, proporcionando una forma estandarizada y automatizada de administrar el ciclo de vida de las aplicaciones en un clúster. En este caso se hace uso de una imagen que contiene lo necesario para correr la aplicacion y ademas se crean 4 replicas, es decir que 4 pods tendran esta aplicacion.</li>
</ul>
<p>Aplicamos el archivo con kubectl para que el cluster los ponga en marcha</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>kubectl<span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span>deployment.yaml
</code></pre></div>
<p>Y listo, podemos comprar que nuestros pods estan funcionando con la aplicacion con el comando</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a>kubectl<span class="w"> </span>get<span class="w"> </span>pods
</code></pre></div>
<p>Podemos entrar a la aplicacion a traves de http://localhost:6000 o podemos consultar la ip que tiene el minikube con</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a>minikube<span class="w"> </span>ip
</code></pre></div>
<p>De esta manera, podemos probar nuestras aplicaciones de forma local para luego mandarlas posteriormente a produccion.</p>
<h2 id="laboratorio">Laboratorio</h2>
<h3 id="multipass">Multipass</h3>
<p>Multipass es un gestor de máquinas virtuales (VM) ligero para Linux, Windows y macOS. Está diseñado para desarrolladores que desean un entorno Ubuntu fresco con un solo comando. Utiliza KVM en Linux, Hyper-V en Windows y QEMU en macOS para ejecutar la VM con una sobrecarga mínima. También puede usar VirtualBox en Windows y macOS. Multipass obtendrá las imágenes por ti y las mantendrá actualizadas.</p>
<p>Dado que admite metadatos para cloud-init, puedes simular un pequeño despliegue en la nube en tu laptop o estación de trabajo.</p>
<p><strong>Instalación</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a>sudo<span class="w"> </span>apt<span class="w"> </span>update
<a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>snapd
<a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a>sudo<span class="w"> </span>snap<span class="w"> </span>install<span class="w"> </span>multipass
</code></pre></div>
<h3 id="creacion-de-instancias">Creación de Instancias</h3>
<p>Los nodos en Kubernetes son simplemente máquinas virtuales que trabajan en sincronización. Para nuestro clúster, crearemos 3 máquinas virtuales, cada una con 2 CPU, 2 GB de RAM y 4 GB de almacenamiento.</p>
<h4 id="claves-ssh">Claves SSH</h4>
<p>Crea una clave privada/pública con el siguiente comando:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a>ssh-keygen
</code></pre></div>
<p>Esto creará los archivos mencionados anteriormente en tu sistema. Copia el contenido de <code>~/.ssh/id_rsa.pub</code> con:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a>cat<span class="w"> </span>~/.ssh/id_rsa.pub
</code></pre></div>
<h4 id="creando-el-archivo-de-configuracion">Creando el archivo de configuración</h4>
<p>Crea un archivo llamado <code>multipass.yaml</code> y coloca tu clave pública en <code>ssh-rsa</code>.</p>
<p><strong>multipass.yaml</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a>yaml
<a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a>ssh_authorized_keys:
<a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a>  - ssh-rsa &lt;añade-tu-clave-pública&gt;
</code></pre></div>
<p>Este archivo de configuración asegura que la clave pública se almacene en la máquina virtual una vez creada. Crearemos nuestras máquinas virtuales con nombres adecuados basados en los roles que les asignaremos (master/worker).</p>
<h4 id="inicializacion">Inicialización</h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a>multipass<span class="w"> </span>launch<span class="w"> </span>jammy<span class="w"> </span>--cpus<span class="w"> </span><span class="m">2</span><span class="w"> </span>--mem<span class="w"> </span>2G<span class="w"> </span>--disk<span class="w"> </span>4G<span class="w"> </span>--name<span class="w"> </span>master-node<span class="w"> </span>--cloud-init<span class="w"> </span>multipass.yaml
<a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a>multipass<span class="w"> </span>launch<span class="w"> </span>jammy<span class="w"> </span>--cpus<span class="w"> </span><span class="m">2</span><span class="w"> </span>--mem<span class="w"> </span>2G<span class="w"> </span>--disk<span class="w"> </span>4G<span class="w"> </span>--name<span class="w"> </span>agent-worker<span class="w"> </span>--cloud-init<span class="w"> </span>multipass.yaml
</code></pre></div>
<p>En términos de K3s, un nodo maestro se llama "server" y el resto de los nodos se llaman "agents". Los agentes son simplemente los nodos que se añaden al nodo maestro; pueden ser otro nodo maestro o un nodo trabajador.</p>
<h3 id="k3sup">k3sup</h3>
<p>k3sup es una utilidad ligera para pasar de cero a KUBECONFIG con k3s en cualquier máquina virtual local o remota. Todo lo que necesitas es acceso SSH y el binario de k3sup para obtener acceso a kubectl de inmediato.</p>
<p>Esta herramienta utiliza SSH para instalar k3s en un host Linux remoto. También puedes usarla para unir hosts Linux existentes a un clúster k3s como agentes. Primero, k3s se instala utilizando el script de utilidad de Rancher, junto con una flag para la IP pública de tu host para que TLS funcione correctamente. Luego, se obtiene y actualiza el archivo kubeconfig en el servidor para que puedas conectarte desde tu laptop usando kubectl.</p>
<p>k3sup se desarrolló para automatizar lo que puede ser un proceso muy manual y confuso para muchos desarrolladores, que ya están cortos de tiempo. Una vez que has provisionado una VM con tu herramienta favorita, k3sup significa que solo estás a 60 segundos de ejecutar <code>kubectl get pods</code> en tu propia computadora. Si estás en una computadora local, puedes omitir SSH con <code>k3sup install --local</code>.</p>
<h3 id="instalacion_2">Instalación</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a>curl<span class="w"> </span>-sLS<span class="w"> </span>https://get.k3sup.dev<span class="w"> </span><span class="p">|</span><span class="w"> </span>sh
<a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a>sudo<span class="w"> </span>install<span class="w"> </span>k3sup<span class="w"> </span>/usr/local/bin/
</code></pre></div>
<h3 id="anadiendo-nodos-con-k3sup">Añadiendo nodos con k3sup</h3>
<p>Ahora que tenemos nuestras VMs listas, instalemos Kubernetes en ellas. Primero, crearemos un nodo maestro para configurar un plano de control.</p>
<h4 id="nodo-maestro">Nodo maestro</h4>
<p>Necesitaremos la IP y el nombre de usuario de nuestra máquina virtual para conectarnos por SSH e instalar Kubernetes. Ejecuta <code>multipass ls</code> y toma nota de la IP del <code>master-node</code>. Todos los nombres de usuario para las VMs son <code>ubuntu</code> por defecto.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a>k3sup<span class="w"> </span>install<span class="w"> </span>--ip<span class="w"> </span>&lt;IP&gt;<span class="w"> </span>--user<span class="w"> </span>ubuntu<span class="w"> </span>--k3s-extra-args<span class="w"> </span><span class="s2">&quot;--cluster-init&quot;</span>
<a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a><span class="nb">export</span><span class="w"> </span><span class="nv">KUBECONFIG</span><span class="o">=</span>&lt;kubeconfig<span class="w"> </span>path&gt;
</code></pre></div>
<p>Pasamos <code>--k3s-extra-args "--cluster-init"</code> para asegurarnos de que este nodo esté preparado para conectarse con otro nodo maestro, de lo contrario, podría causar errores.</p>
<p>Una vez instalado, descarga el archivo <code>kubeconfig</code> en el directorio donde ejecutaste tu comando. Puedes configurar la variable de entorno <code>KUBECONFIG</code> con la ruta al archivo <code>kubeconfig</code> recientemente descargado.</p>
<p>Ahora puedes usar <code>kubectl get nodes</code> para ver los nodos en tu clúster.</p>
<h4 id="nodo-worker">Nodo worker</h4>
<p>Finalmente, tenemos que configurar nuestro nodo trabajador donde desplegaremos nuestras aplicaciones y servicios.</p>
<p>Para esto, toma la IP del <code>agent-worker</code> y pasa el mismo comando que antes, pero sin la bandera <code>--server</code>.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a>$<span class="w"> </span>k3sup<span class="w"> </span>join<span class="w"> </span>--ip<span class="w"> </span>&lt;IP-del-agent-worker&gt;<span class="w"> </span>--user<span class="w"> </span>ubuntu<span class="w"> </span>--server-ip<span class="w"> </span>&lt;IP-del-master-node&gt;<span class="w"> </span>--server-user<span class="w"> </span>ubuntu
</code></pre></div>
<p>Ahora, si ejecutas <code>kubectl get nodes</code>, encontrarás dos nodos maestros y un único nodo trabajador que componen tu configuración de clúster multinodo. Puedes crear nuevas VMs y agregar más nodos maestros o trabajadores dependiendo de cómo planees utilizar tu clúster.</p>
<h2 id="referencias">Referencias</h2>
<p><a href="https://ohmyz.sh/">oh my zsh!</a></p>
<p><a href="https://linux-kvm.org/page/Main_Page">Linux KVM</a></p>
<p><a href="https://minikube.sigs.k8s.io/docs/">Minikube Documentación Oficial</a></p>
<p><a href="https://github.com/canonical/multipass">Multipass Github Oficial</a></p>
<p><a href="https://github.com/alexellis/k3sup">k3sup Github Oficial</a></p>
<p><a href="https://yankeexe.medium.com/setting-up-multi-node-kubernetes-cluster-with-k3s-and-multipass-d4efed47fed5">Setting up multi-node Kubernetes cluster locally with K3s and Multipass</a></p>
<p><a href="https://billtcheng2013.medium.com/multi-node-kubernetes-cluster-setup-using-multipass-k3s-up-to-date-e0c61645e265">Multi-node Kubernetes cluster setup using Multipass/k3s</a></p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Volver al principio
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      &copy; 2024 <a href="https://www.ing.unrc.edu.ar/inicio.php"  target="_blank" rel="noopener">Universidad Nacional de Río cuarto | Facultad de Ingeniería</a>
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
    <a href="https://github.com/danunziata/pps_fede_Ferro_2024" target="_blank" rel="noopener" title="Repo URL" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.sections", "navigation.path", "navigation.top"], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copiado al portapapeles", "clipboard.copy": "Copiar al portapapeles", "search.result.more.one": "1 m\u00e1s en esta p\u00e1gina", "search.result.more.other": "# m\u00e1s en esta p\u00e1gina", "search.result.none": "No se encontraron documentos", "search.result.one": "1 documento encontrado", "search.result.other": "# documentos encontrados", "search.result.placeholder": "Teclee para comenzar b\u00fasqueda", "search.result.term.missing": "Falta", "select.version": "Seleccionar versi\u00f3n"}}</script>
    
    
      <script src="../assets/javascripts/bundle.ad660dcc.min.js"></script>
      
    
  </body>
</html>